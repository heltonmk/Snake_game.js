function draw(b){var d=document.getElementById(b);var c=d.getContext("2d");var f=Snake();f.init({pos_x:4,pos_y:4,v_x:1,v_y:0});var a=FoodList();a.addFoodRandom(f);$(document).keyup(function(h){var g=(h.keyCode?h.keyCode:h.which);switch(g){case 37:f.goLeft();return false;case 39:f.goRight();return false;case 38:f.goUp();return false;case 40:f.goDown();return false}});var e=window.setInterval(function(){d.width=d.width;c.strokeRect(0,0,GameParameters.board_width*GameParameters.block_size,GameParameters.board_height*GameParameters.block_size);f.iterate();eatDetection(f,a);if(outOfBoundsDetection(f)||f.checkTailCollision()){window.clearInterval(e);drawGameOver(c);gameInitialized=false;return}f.paint(c);a.paint(c)},200)}function drawGameOver(a){var b=a.createLinearGradient(0,0,0,GameParameters.board_height*GameParameters.block_size);b.addColorStop(0,"black");b.addColorStop(1,"#565656");a.fillStyle=b;a.fillRect(0,0,GameParameters.board_width*GameParameters.block_size,GameParameters.board_height*GameParameters.block_size);a.font="bold 30px sans-serif";a.fillStyle="white";a.fillText("GAME OVER",60,(GameParameters.board_width*GameParameters.block_size)/2);a.font="bold 15px sans-serif";a.fillText("Press SPACE to restart game!",45,(GameParameters.board_height*GameParameters.block_size)/2+30)}function drawWelcomeScreen(a){var c=document.getElementById(a);var b=c.getContext("2d");var d=b.createLinearGradient(0,0,0,GameParameters.board_height*GameParameters.block_size);d.addColorStop(0,"black");d.addColorStop(1,"#565656");b.fillStyle=d;b.fillRect(0,0,GameParameters.board_width*GameParameters.block_size,GameParameters.board_height*GameParameters.block_size);b.font="bold 30px sans-serif";b.fillStyle="white";b.fillText("Snake game",70,(GameParameters.board_height*GameParameters.block_size)/2-10);b.font="bold 15px sans-serif";b.fillStyle="white";b.fillText("Press SPACE to start game!",55,(GameParameters.board_height*GameParameters.block_size)/2+20)}var GameParameters={block_size:20,board_width:15,board_height:15};var Snake=(function(){var d={},a=[],h=0,g=1,c=2,e=3,b=g,f,i=1;d.init=function(k){var j=Block();b=g;j.init(k);a.push(j)};d.iterate=function(){var j=[];for(var l=0;l<a.length;l++){var k=a[l].iterate()}for(l=a.length-1;l>0;l--){prev_block_speed=a[l-1].getSpeed();a[l].setSpeed(prev_block_speed[0],prev_block_speed[1])}f=false};d.paint=function(j){for(var k=0;k<a.length;k++){a[k].paint(j,"black")}};d.head_position=function(){return a[0].getPosition()};d.eat=function(){var k,j;k=Block();j=a[a.length-1].getPosition();_last_block_speed=a[a.length-1].getSpeed();k.init({pos_x:j[0]-_last_block_speed[0],pos_y:j[1]-_last_block_speed[1],v_x:_last_block_speed[0],v_y:_last_block_speed[1]});i+=1;a.push(k)};d.checkTailCollision=function(){var j=a[0].getPosition();for(var k=1;k<a.length;k++){_blockPos=a[k].getPosition();if(j[0]===_blockPos[0]&&j[1]===_blockPos[1]){console.log("Snake hit himself at "+j[0]+" "+j[1]);return true}}return false};d.isOn=function(j,l){for(var k=0;k<a.length;k++){_blockPos=a[k].getPosition();if(_blockPos[0]===j&&_blockPos[1]===l){return true}}return false};d.goUp=function(){if(b!=c&&(f===false)){a[0].goUp();b=h;f=true}};d.goDown=function(){if(b!=h&&(f===false)){a[0].goDown();b=c;f=true}};d.goLeft=function(){if(b!=g&&(f===false)){a[0].goLeft();b=e;f=true}};d.goRight=function(){if(b!=e&&(f===false)){a[0].goRight();b=g;f=true}};return d});var FoodList=(function(){var a={};a.list=[];a.addFood=function(c,d){var b=Block();b.init({pos_x:c,pos_y:d,v_x:0,v_y:0});a.list.push(b)};a.addFoodRandom=function(c){var b,d;while(true){b=Math.floor(Math.random()*GameParameters.board_width);d=Math.floor(Math.random()*GameParameters.board_height);if(c.isOn(b,d)===false){break}}a.addFood(b,d)};a.removeFood=function(b,d){for(var c=0;c<a.list.length;c++){item_pos=a.list[c].getPosition();if(item_pos[0]===b&&item_pos[1]===d){a.list.splice(c,1)}}};a.paint=function(b){for(var c=0;c<a.list.length;c++){a.list[c].paint(b,"red")}};return a});var Block=(function(){var e={},c=0,a=0,d=1,b=0;e.init=function(f){c=f.pos_x;a=f.pos_y;d=f.v_x;b=f.v_y};e.iterate=function(){c+=d;a+=b;result={};result.pos_x=c;result.pos_y=a;return result};e.setSpeed=function(g,f){d=g;b=f};e.getSpeed=function(){return[d,b]};e.getPosition=function(){return[c,a]};e.goUp=function(){b=-1;d=0};e.goDown=function(){b=1;d=0};e.goLeft=function(){d=-1;b=0};e.goRight=function(){d=1;b=0};e.paint=function(g,f){var h=g.createLinearGradient(c*GameParameters.block_size,a*GameParameters.block_size,(c+1)*GameParameters.block_size,(a+1)*GameParameters.block_size);h.addColorStop(0,f);h.addColorStop(1,"#747474");g.fillStyle=h;g.fillRect(c*GameParameters.block_size,a*GameParameters.block_size,GameParameters.block_size,GameParameters.block_size)};return e});function eatDetection(e,d){var b=e.head_position();var a=[];for(var c=0;c<d.list.length;c++){item_pos=d.list[c].getPosition();if(item_pos[0]===b[0]&&item_pos[1]===b[1]){a.push(c)}}for(c=0;c<a.length;c++){d.list.splice(a[c],1);e.eat();d.addFoodRandom(e)}}function outOfBoundsDetection(b){var a=b.head_position();if(a[0]>=GameParameters.board_width||a[0]<0||a[1]>=GameParameters.board_height||a[1]<0){console.log("Out of bounds! Game over!");console.log("Board width: "+GameParameters.board_width);console.log("Board height: "+GameParameters.board_height);console.log("Snake x : "+a[0]);console.log("Snake y : "+a[1]);return true}return false}var gameInitialized=false;$(document).onload=(function(){drawWelcomeScreen("drawArea");$(document).keyup(function(b){var a=(b.keyCode?b.keyCode:b.which);if(a===32){if(gameInitialized===false){draw("drawArea");gameInitialized=true}return false}})})();